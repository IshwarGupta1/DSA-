URL Shortener â€“ Flashcard Style
ğŸ’¡ Functional Requirements
Shorten long URLs.

Redirect short URLs to long ones.

Allow custom aliases (optional).

Track analytics (optional).

ğŸ“¶ Non-Functional Requirements
High availability & low latency.

Scalable (100M writes/day, 1B reads/day).

Peak read traffic â‰ˆ 116K req/sec.

ğŸ“¦ Storage Estimation
100 bytes per long URL.

~365 GB/year (without indexing/analytics).

ğŸ“ API Design
1. Shorten URL

bash
Copy
Edit
POST /api/v1/shorten
Fields:

long_url

custom_alias (optional)

expiry_date (optional)

2. Redirect URL

bash
Copy
Edit
GET /api/v1/redirect/{short_url}
3. View Analytics

bash
Copy
Edit
GET /api/v1/analytics/{short_url}
ğŸ§± Database Design (NoSQL)

Column	Type
short_url	String (PK)
long_url	String
created_at	Timestamp
expires_at	Timestamp
custom_alias	String
Use TTL for expiry-based cleanup.

ğŸ”¢ Short URL Generation Methods
Base62 Encoding (IDs â†’ short, unique string).

Hashing (long URL + salt â†’ 7-char string).

Custom Alias stored directly with conflict check.

ğŸ§  Caching
Redis for hot URLs (20% of URLs get 80% of traffic).

20M popular URLs Ã— 100 bytes â‰ˆ 2 GB in cache.

ğŸ“Š Analytics
Track on redirect:

IP address â†’ Geo location

Device â†’ User-agent

Referrer â†’ Source

Use Kafka â†’ Async logging â†’ Analytics DB.

ğŸ“ˆ Analytics API Response Example
json
Copy
Edit
{
  "total_clicks": 2042,
  "last_7_days": [{ "date": "2025-04-15", "clicks": 120 }],
  "top_countries": ["US", "IN", "DE"],
  "devices": ["Mobile", "Desktop"]
}
ğŸ›¡ï¸ Additional Features
âœ… Rate Limiting (Token Bucket, per IP or API key).

ğŸ” Validation (long URL, safe links).

â³ Expiry Handling (auto-clean with background job).

ğŸš« Blacklist/Spam Detection (Safe Browsing API).

ğŸ—ï¸ High-Level Architecture
css
Copy
Edit
[Client] â†’ [LB] â†’ [Web Server]
                    â†“
        [Shortening/Redirect Service]
                    â†“
           [Cache] â†â†’ [DB]
                    â†“
           [Message Queue] â†’ [Analytics Store]
âš™ï¸ Scaling Strategy
Stateless services â†’ scale web servers.

DB sharding by short URL or ID.

Async logging â†’ scale consumers.

Cache eviction policy: LRU.

âš–ï¸ Read vs Write Load

Type	Avg Req/sec	Peak
Write	1.1K	11K
Read	11K	116K
